
> nggk-tau-ini-apa@1.0.0 test
> cross-env NODE_ENV=test node --experimental-vm-modules node_modules/jest/bin/jest.js --coverage --passWithNoTests --testPathPattern=unit/controllers.test.js --no-cache

  console.log
    [dotenv@17.2.3] injecting env (9) from .env -- tip: ✅ audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

node.exe : [baseline-b
rowser-mapping] The 
data in this module 
is over two months 
old.  To ensure 
accurate Baseline 
data, please update: 
`npm i baseline-browse
r-mapping@latest -D`
At line:1 char:1
+ & "D:\ENV\NodeJS/nod
e.exe" "C:\Users\Renz\
AppData\Roaming\npm/no
de_mo ...
+ ~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~
~~~~~
    + CategoryInfo    
          : NotSpeci  
  fied: ([baseline-   
 brows...ping@late    
st -D`:String) []    
, RemoteException
    + FullyQualifiedE 
   rrorId : NativeCo  
  mmandError
 
  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: 🛠️  run anywhere with `dotenvx run -- yourcommand`

      at _log (node_modules/dotenv/lib/main.js:142:11)

(node:13760) 
ExperimentalWarning: 
VM Modules is an 
experimental feature 
and might change at 
any time
(Use `node 
--trace-warnings ...` 
to show where the 
warning was created)
FAIL __tests__/unit/co
ntrollers.test.js
  Controller Unit 
Tests
    AuthController
      login
        √ should 
return 400 if fields 
missing (3 ms)
        √ should 
login successfully 
for Mahasiswa (141 ms)
        √ should 
return 400 if user 
not found (128 ms)
      
registerMahasiswa
        √ should 
register new 
mahasiswa 
successfully (61 ms)
        √ should 
return 400 if email 
already exists
    
MahasiswaController
      getProfile
        √ should 
return profile with 
dosen info (1 ms)
        √ should 
return 404 if not 
found
      submitProposal
        √ should 
submit proposal 
successfully (1 ms)
        √ should 
return 400 if track 
not set
      getBimbinganList
        √ should 
return list of 
bimbingan (1 ms)
    AdminController
      getStats
        √ should 
return dashboard stats
      getAllUsers
        √ should 
return user list (1 
ms)
    DosenController
      getProfile
        √ should 
return profile with 
roles
      
getMahasiswaBimbingan
        √ should 
return mahasiswa list 
(1 ms)
    
BimbinganController
      createBimbingan
        × should 
create bimbingan 
successfully (1 ms)
      
getDosenBimbingan
        × should 
return list of 
bimbingan for dosen 
(2 ms)
    JadwalController
      getActive
        × should 
return active 
schedules (1 ms)
      create
        × should 
create new jadwal (1 
ms)
    KelompokController
      createKelompok
        × should 
create kelompok 
successfully (1 ms)
    
KoordinatorController
      getStats
        × should 
return koordinator 
stats
    KaprodiController
      
getDashboardStats
        × should 
return kaprodi 
dashboard stats (1 ms)
    
NotificationController
      getStats
        × should 
return notification 
stats for Dosen
    SidangController
      submitLaporan
        × should 
submit laporan 
successfully
      scheduleSidang
        × should 
schedule sidang 
successfully (1 ms)

  ● Controller Unit 
Tests › 
BimbinganController › 
createBimbingan › 
should create 
bimbingan successfully

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 201
    Received: 400

    Number of calls: 1

    [0m [90m 351 
|[39m                
 [36mawait[39m bimbi
nganController[33m.[
39mcreateBimbingan(req
[33m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 352 |[39m
    [31m[1m>[22m[3
9m[90m 353 |[39m    
             expect(re
s[33m.[39mstatus)[3
3m.[39mtoHaveBeenCall
edWith([35m201[39m)
[33m;[39m
     [90m     |[39m 
                      
             
[31m[1m^[22m[39m
     [90m 354 |[39m 
            
})[33m;[39m
     [90m 355 |[39m 
        })[33m;[39m
     [90m 356 
|[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:353:36)

  ● Controller Unit 
Tests › 
BimbinganController › 
getDosenBimbingan › 
should return list of 
bimbingan for dosen

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    - Expected
    + Received

      Array [
        Object {
    -     "id": 100,
    -     "topik": 
"Topik 1",
    +     "dosen_id": 
10,
        },
      ],

    Number of calls: 1

    [0m [90m 365 
|[39m                
 [36mawait[39m bimbi
nganController[33m.[
39mgetDosenBimbingan(r
eq[33m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 366 |[39m
    [31m[1m>[22m[3
9m[90m 367 |[39m    
             expect(re
s[33m.[39mjson)[33m
.[39mtoHaveBeenCalled
With(mockList)[33m;[
39m
     [90m     |[39m 
                      
           
[31m[1m^[22m[39m
     [90m 368 |[39m 
            
})[33m;[39m
     [90m 369 |[39m 
        })[33m;[39m
     [90m 370 |[39m 
    })[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:367:34)

  ● Controller Unit 
Tests › 
JadwalController › 
getActive › should 
return active 
schedules

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    - Expected
    + Received

      Array [
        Object {
    -     "id": 1,
    -     "nama": 
"Jadwal 1",
    -     "status": 
"active",
    +     "total": 0,
        },
      ],

    Number of calls: 1

    [0m [90m 384 
|[39m                
 [36mawait[39m jadwa
lController[33m.[39m
getActive(req[33m,[3
9m res[33m,[39m 
mockNext)[33m;[39m
     [90m 385 |[39m
    [31m[1m>[22m[3
9m[90m 386 |[39m    
             expect(re
s[33m.[39mjson)[33m
.[39mtoHaveBeenCalled
With(mockSchedules)[3
3m;[39m
     [90m     |[39m 
                      
           
[31m[1m^[22m[39m
     [90m 387 |[39m 
            
})[33m;[39m
     [90m 388 |[39m 
        })[33m;[39m
     [90m 389 
|[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:386:34)

  ● Controller Unit 
Tests › 
JadwalController › 
create › should 
create new jadwal

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 201

    Number of calls: 0

    [0m [90m 412 
|[39m                
 [36mawait[39m jadwa
lController[33m.[39m
create(req[33m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 413 |[39m
    [31m[1m>[22m[3
9m[90m 414 |[39m    
             expect(re
s[33m.[39mstatus)[3
3m.[39mtoHaveBeenCall
edWith([35m201[39m)
[33m;[39m
     [90m     |[39m 
                      
             
[31m[1m^[22m[39m
     [90m 415 |[39m 
            
})[33m;[39m
     [90m 416 |[39m 
        })[33m;[39m
     [90m 417 |[39m 
    })[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:414:36)

  ● Controller Unit 
Tests › 
KelompokController › 
createKelompok › 
should create 
kelompok successfully

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 201

    Number of calls: 0

    [0m [90m 435 
|[39m                
 [36mawait[39m kelom
pokController[33m.[3
9mcreateKelompok(req[
33m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 436 |[39m
    [31m[1m>[22m[3
9m[90m 437 |[39m    
             expect(re
s[33m.[39mstatus)[3
3m.[39mtoHaveBeenCall
edWith([35m201[39m)
[33m;[39m
     [90m     |[39m 
                      
             
[31m[1m^[22m[39m
     [90m 438 |[39m 
            
})[33m;[39m
     [90m 439 |[39m 
        })[33m;[39m
     [90m 440 |[39m 
    })[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:437:36)

  ● Controller Unit 
Tests › 
KoordinatorController 
› getStats › should 
return koordinator 
stats

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 
ObjectContaining 
{"proposal_pending": 
5, "total_mahasiswa": 
100}

    Number of calls: 0

    [0m [90m 456 
|[39m                
 [36mawait[39m koord
inatorController[33m.
[39mgetStats(req[33m
,[39m res[33m,[39m 
mockNext)[33m;[39m
     [90m 457 |[39m
    [31m[1m>[22m[3
9m[90m 458 |[39m    
             expect(re
s[33m.[39mjson)[33m
.[39mtoHaveBeenCalled
With(expect[33m.[39m
objectContaining({
     [90m     |[39m 
                      
           
[31m[1m^[22m[39m
     [90m 459 |[39m 
                    to
tal_mahasiswa[33m:[3
9m [35m100[39m[33m,
[39m
     [90m 460 |[39m 
                    pr
oposal_pending[33m:[
39m [35m5[39m
     [90m 461 |[39m 
                
}))[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:458:34)

  ● Controller Unit 
Tests › 
KaprodiController › 
getDashboardStats › 
should return kaprodi 
dashboard stats

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 
ObjectContaining {"lul
us_semester_ini": 20, 
"total_mahasiswa": 
200}

    Number of calls: 0

    [0m [90m 489 
|[39m                
 [36mawait[39m kapro
diController[33m.[39
mgetDashboardStats(req
[33m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 490 |[39m
    [31m[1m>[22m[3
9m[90m 491 |[39m    
             expect(re
s[33m.[39mjson)[33m
.[39mtoHaveBeenCalled
With(expect[33m.[39m
objectContaining({
     [90m     |[39m 
                      
           
[31m[1m^[22m[39m
     [90m 492 |[39m 
                    to
tal_mahasiswa[33m:[3
9m [35m200[39m[33m,
[39m
     [90m 493 |[39m 
                    lu
lus_semester_ini[33m:
[39m [35m20[39m
     [90m 494 |[39m 
                
}))[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:491:34)

  ● Controller Unit 
Tests › NotificationCo
ntroller › getStats › 
should return 
notification stats 
for Dosen

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 
{"laporan-approve": 
1, "mahasiswa-bimbinga
n": 2}

    Number of calls: 0

    [0m [90m 511 
|[39m                
 [36mawait[39m notif
icationController[33m
.[39mgetStats(req[33
m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 512 |[39m
    [31m[1m>[22m[3
9m[90m 513 |[39m    
             expect(re
s[33m.[39mjson)[33m
.[39mtoHaveBeenCalled
With({
     [90m     |[39m 
                      
           
[31m[1m^[22m[39m
     [90m 514 |[39m 
                    [
32m'mahasiswa-bimbinga
n'[39m[33m:[39m 
[35m2[39m[33m,[39m
     [90m 515 |[39m 
                    [
32m'laporan-approve'[
39m[33m:[39m 
[35m1[39m
     [90m 516 |[39m 
                
})[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:513:34)

  ● Controller Unit 
Tests › 
SidangController › 
submitLaporan › 
should submit laporan 
successfully

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 201

    Number of calls: 0

    [0m [90m 552 
|[39m                
 [36mawait[39m sidan
gController[33m.[39m
submitLaporan(req[33m
,[39m res[33m,[39m 
mockNext)[33m;[39m
     [90m 553 |[39m
    [31m[1m>[22m[3
9m[90m 554 |[39m    
             expect(re
s[33m.[39mstatus)[3
3m.[39mtoHaveBeenCall
edWith([35m201[39m)
[33m;[39m
     [90m     |[39m 
                      
             
[31m[1m^[22m[39m
     [90m 555 |[39m 
            
})[33m;[39m
     [90m 556 |[39m 
        })[33m;[39m
     [90m 557 
|[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:554:36)

  ● Controller Unit 
Tests › 
SidangController › 
scheduleSidang › 
should schedule 
sidang successfully

    expect(jest.fn()).
toHaveBeenCalledWith(.
..expected)

    Expected: 201
    Received: 400

    Number of calls: 1

    [0m [90m 580 
|[39m                
 [36mawait[39m sidan
gController[33m.[39m
scheduleSidang(req[33
m,[39m 
res[33m,[39m 
mockNext)[33m;[39m
     [90m 581 |[39m
    [31m[1m>[22m[3
9m[90m 582 |[39m    
             expect(re
s[33m.[39mstatus)[3
3m.[39mtoHaveBeenCall
edWith([35m201[39m)
[33m;[39m
     [90m     |[39m 
                      
             
[31m[1m^[22m[39m
     [90m 583 |[39m 
            
})[33m;[39m
     [90m 584 |[39m 
        })[33m;[39m
     [90m 585 |[39m 
    })[33m;[39m[0m

      at 
Object.<anonymous> (__
tests__/unit/controlle
rs.test.js:582:36)

----------------------------|---------|----------|---------|---------|------------------------------------------------
File                        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                              
----------------------------|---------|----------|---------|---------|------------------------------------------------
All files                   |   14.52 |    12.25 |    15.6 |   14.43 |                                                
 controllers                |    19.6 |    16.15 |   21.83 |   19.52 |                                                
  adminController.js        |   41.17 |    33.33 |   18.18 |   37.83 | 6,22,27,37,46,86-123,138,151,155-285           
  authController.js         |   30.63 |    27.02 |   33.33 |   30.63 | 22,34,51-52,63,68,85-93,105,111-278            
  bimbinganController.js    |      25 |       24 |      40 |      25 | 10,21,29-85,108-170                            
  dosenController.js        |   27.77 |       50 |   33.33 |   27.77 | 17,22,51-156                                   
  jadwalController.js       |   16.21 |    14.89 |      40 |   16.21 | 5-13,28,36,42,58-110,117-197                   
  kaprodiController.js      |     3.7 |        0 |    6.66 |    4.08 | 8-38,64-115,140-376                            
  kelompokController.js     |   13.63 |     6.66 |      20 |   13.63 | 10,21,25-53,65-209                             
  koordinatorController.js  |   13.46 |        0 |   16.66 |   13.72 | 8-147,168,181-192                              
  mahasiswaController.js    |   21.05 |    18.57 |    37.5 |   21.05 | 30-161,172,189,197-203,211-217,230-296,316-391 
  notificationController.js |   33.33 |    13.33 |     100 |   36.36 | 23-70                                          
  sharedController.js       |     1.2 |        0 |       0 |    1.23 | 12-253                                         
  sidangController.js       |   14.16 |    18.86 |      20 |   15.31 | 11,26-77,87-208,219,230,237-336                
 middleware                 |       0 |        0 |       0 |       0 |                                                
  auth.js                   |       0 |        0 |       0 |       0 | 4-22                                           
  role.js                   |       0 |        0 |       0 |       0 | 5-50                                           
  upload.js                 |       0 |        0 |       0 |       0 | 4-67                                           
 routes                     |       0 |        0 |       0 |       0 |                                                
  adminRoutes.js            |       0 |      100 |     100 |       0 | 6-28                                           
  authRoutes.js             |       0 |      100 |     100 |       0 | 5-21                                           
  bimbinganRoutes.js        |       0 |        0 |       0 |       0 | 8-40                                           
  dosenRoutes.js            |       0 |      100 |     100 |       0 | 8-32                                           
  kaprodiRoutes.js          |       0 |      100 |     100 |       0 | 6-27                                           
  koordinatorRoutes.js      |       0 |      100 |     100 |       0 | 8-40                                           
  mahasiswaRoutes.js        |       0 |      100 |     100 |       0 | 9-42                                           
  notificationRoutes.js     |       0 |      100 |     100 |       0 | 5-8                                            
  pengujiRoutes.js          |       0 |        0 |       0 |       0 | 6-45                                           
  profileRoutes.js          |       0 |        0 |       0 |       0 | 7-63                                           
  proposalRoutes.js         |       0 |        0 |       0 |       0 | 8-58                                           
  reportRoutes.js           |       0 |        0 |       0 |       0 | 8-51                                           
  sidangRoutes.js           |       0 |      100 |       0 |       0 | 8-30                                           
 utils                      |     5.4 |     1.28 |    8.57 |    5.71 |                                                
  constants.js              |   17.64 |        0 |       0 |   18.75 | 25-26,40-71                                    
  gcs.js                    |       0 |        0 |       0 |       0 | 3-42                                           
  gdrive.js                 |       0 |        0 |       0 |       0 | 12-191                                         
  httpResponses.js          |       0 |        0 |       0 |       0 | 6-54                                           
  jwt.js                    |     100 |       50 |     100 |     100 | 13                                             
  password.js               |     100 |      100 |     100 |     100 |                                                
  roleHelper.js             |       0 |        0 |       0 |       0 | 13-157                                         
----------------------------|---------|----------|---------|---------|------------------------------------------------
Test Suites: 1 
failed, 1 total
Tests:       10 
failed, 14 passed, 24 
total
Snapshots:   0 total
Time:        3.031 s
Ran all test suites 
matching /unit\\contro
llers.test.js/i.
